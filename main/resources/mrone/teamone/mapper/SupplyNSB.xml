<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
    
<mapper namespace="mrone.teamone.mapper.SupplyNSB">
    

    <select id="getSupplyWaitOrderList" parameterType="String" resultType="mrone.teamone.beans.RequestOrderBean">
	SELECT 
	RE_CODE,
	RE_CLCODE,
	RE_SPCODE,
	RE_DATE,
	RE_STATE
	FROM RE WHERE RE_STATE = 'OR'AND RE_SPCODE = #{sp}
    </select>
    
    <select id="getSupplyClearOrderList" parameterType="String" resultType="mrone.teamone.beans.RequestOrderBean">
	SELECT 
	RE_CODE,
	RE_CLCODE,
	RE_SPCODE,
	RE_DATE,
	RE_STATE
	FROM RE WHERE RE_STATE = 'OA'AND RE_SPCODE = #{sp}
    </select>
    
    <select id="getSupplyWaitOrderListD" parameterType="mrone.teamone.beans.RequestOrderBean" resultType="mrone.teamone.beans.RequestOrderDetailBean">
	SELECT 
	RD_PRSPCODE, 
	RD_RECODE, 
	PR_CODE, 
	RD_QUANTITY, 
	RD_STCODE 
	FROM RD INNER JOIN PR ON RD.RD_PRCODE = PR.PR_CODE WHERE RD_RECODE = #{re_code}
    </select>
    
    <select id="getSupplyClearOrderListD" parameterType="mrone.teamone.beans.RequestOrderBean" resultType="mrone.teamone.beans.RequestOrderDetailBean">
	SELECT 
	RD_PRSPCODE, 
	RD_RECODE, 
	PR_CODE, 
	RD_QUANTITY, 
	RD_STCODE 
	FROM RD INNER JOIN PR ON RD.RD_PRCODE = PR.PR_CODE WHERE RD_RECODE = #{re_code}
    </select>
    
    <select id="updateRequestOrderState" parameterType="mrone.teamone.beans.RequestOrderDetailBean" resultType="mrone.teamone.beans.RequestOrderBean">
	UPDATE REQUEST SET RE_STATE = 'OA' WHERE RE_CODE = #{rd_recode}
    </select>
    
    <select id="updateRequestOrderState2" parameterType="mrone.teamone.beans.RequestOrderDetailBean" resultType="mrone.teamone.beans.RequestOrderBean">
	UPDATE REQUESTDETAIL SET RD_STCODE = 'OA' WHERE RD_RECODE = #{rd_recode}
    </select>
    
    <insert id="insertDL" parameterType="mrone.teamone.beans.RequestOrderDetailBean" >
	INSERT INTO DELIVERY VALUES ('222222222', #{rd_recode}, '1', 'ANY000', '000000000')
    </insert>
    
    <select id="getDLlist"  resultType="mrone.teamone.beans.DeliveryBean">
	SELECT 
	DL_CODE, 
	DL_OSCODE, 
	DS_CODE, 
	DS_NAME, 
	DV_CODE, 
	DV_NAME, 
    DL_LCCODE 
	FROM DL INNER JOIN DS ON DL.DL_DSCODE = DS.DS_CODE INNER JOIN "DV" ON DL.DL_DVCODE = DV.DV_CODE
    </select>
    
    <update id="updateDL" parameterType="mrone.teamone.beans.DeliveryBean">
 		UPDATE DL SET DL_DSCODE = '2', DL_DVCODE = #{dl_dvcode} WHERE DL_CODE = #{dl_code}
    </update>
    
    <select id="getTaxCL"  resultType="mrone.teamone.beans.ClientInfoBean">
	SELECT 
	CL_CODE, 
	CL_NAME, 
	CL_ADDRESS, 
	CL_CORPNUM   
	FROM CL
    </select>
    
    <select id="choiceSPInfo"  resultType="mrone.teamone.beans.SupplyInfoBean">
	SELECT 
	SP_CODE, 
	SP_NAME, 
	SP_ADDRESS, 
	SP_CORPNUM,  
	SP_TEL, 
	SP_BTYPE, 
	SP_BKIND  
	FROM SP WHERE SP_CODE = 'KR001D'
    </select>
    
     <select id="choiceCLInfo"  resultType="mrone.teamone.beans.ClientInfoBean">
	SELECT 
	CL_CODE, 
	CL_NAME, 
	CL_ADDRESS, 
	CL_CORPNUM,  
	CL_HP, 
	CL_BTYPE, 
	CL_BKIND  
	FROM CL WHERE CL_CODE = #{cl_code}
    </select>
    
    <select id="getTaxDill"  resultType="mrone.teamone.beans.RequestOrderBean">
	SELECT 
	RE_CODE, 
	RE_CLCODE, 
	CL_NAME   
	FROM RE INNER JOIN CL ON RE.RE_CLCODE = CL.CL_CODE WHERE RE_SPCODE = 'KR001D'
    </select>
    
    <select id="choiceDillInfo"  resultType="mrone.teamone.beans.RequestOrderDetailBean">
	SELECT 
	PR_NAME, 
	RD_QUANTITY, 
	PR_PRICE, 
	PR_TAX 
	FROM RD INNER JOIN PR ON RD.RD_PRCODE = PR.PR_CODE WHERE RD_PRSPCODE = 'KR001D'AND RD_RECODE = #{rd_recode}
    </select>
   
    
</mapper>

