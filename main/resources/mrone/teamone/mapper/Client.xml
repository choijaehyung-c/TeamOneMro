<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
    
<mapper namespace="mrone.teamone.mapper.Client">

	<select id="isClient" parameterType="string" resultType="int">
		SELECT COUNT(*) FROM CL WHERE CL_CODE = #{cl_code}
	</select>
	
	<select id="isClientPwd" parameterType="string" resultType="int">
		SELECT COUNT(*) FROM CL WHERE CL_PWD = #{cl_pwd}
	</select>
	
	<insert id="insClientOrder" parameterType="mrone.teamone.beans.ClientOrderBean">
		INSERT INTO OS VALUES(TO_CHAR(SYSDATE,'YYMMDD')||SEQ_CLIENT_ORDERNUMBER.NEXTVAL,#{os_clcode},TO_DATE(#{os_date},'YYYYMMDDHH24miss'),#{os_state},#{os_origin},#{os_region})
	</insert>
	
	<insert id="insClientOrderDetail" parameterType="mrone.teamone.beans.OrderDetailBean">
		INSERT INTO OD VALUES(#{od_prspcode},#{od_oscode},#{od_stcode},#{od_prcode},#{od_quantity},#{od_note})
	</insert>
	
	<select id="getOrderData" parameterType="mrone.teamone.beans.ClientOrderBean" resultType="string">
		SELECT MAX(OS_CODE) FROM OS WHERE OS_CLCODE = #{os_clcode}
	</select>

	<select id="getTaxBillList" parameterType="mrone.teamone.beans.ClientInfoBean" resultType="mrone.teamone.beans.ClientInfoBean">
		SELECT TB_CODE,TB_OSCODE,TB_SPNAME,TB_CLNAME,TB_DATE,TB_TTPRICE FROM TB WHERE TB_CLCODE = #{cl_code}
	</select>
	
	<select id="getTaxBillDetail" parameterType="mrone.teamone.beans.ClientInfoBean" resultType="mrone.teamone.beans.ClientInfoBean">
		SELECT * FROM TB WHERE TB_CODE = #{tb_code}
	</select>
	
	<update id="updOrderDecide" parameterType="string">
		UPDATE OS SET OS_STATE = 'OC' WHERE OS_CODE = #{os_code} AND OS_STATE = 'OA'
	</update>
	
	<update id="updOrderDetailDecide" parameterType="string">
		UPDATE OD SET OD_STCODE = 'OC' WHERE OD_OSCODE = #{os_code} AND OD_STCODE = 'OA'
	</update>
	
	<update id="updRequestDecide" parameterType="string">
		UPDATE RE SET RE_STATE = 'OC' WHERE RE_OSCODE = #{os_code} AND RE_STATE = 'OA'
	</update>
	
	<update id="updRequestDetailDecide" parameterType="string">
		UPDATE RD SET RD_STCODE = 'OC' WHERE RD_RECODE = #{re_code} AND RD_STCODE = 'OA'
	</update>
	
	<select id="getOscodeRe" parameterType="string" resultType="string">
		SELECT OS_CODE FROM RE WHERE RE_CODE = #{re_code}
	</select>
	

	
	
	
</mapper>