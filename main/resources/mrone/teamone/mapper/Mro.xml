<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
    
<mapper namespace="mrone.teamone.mapper.Mro">
	<insert id="insMroRequestOrder">
		INSERT INTO RE VALUES(TO_CHAR(SYSDATE,'YYMMDD')||SEQ_MRO_REQUESTNUMBER.NEXTVAL,
		#{re_clcode},#{re_spcode},#{re_oscode},TO_DATE(#{re_date},'YYYYMMDDHH24miss'),#{re_state})
	</insert>

	<insert id="insMroRequestOrderDetail">
		INSERT INTO RD VALUES(#{rd_prspcode},#{rd_recode},#{pr_code},#{rd_quantity},#{rd_stcode},#{rd_note})
	</insert>

	<select id="getRequestOrderData">
		SELECT RE_CODE FROM RE WHERE RE_CLCODE = #{re_clcode} and RE_DATE = TO_DATE(#{re_date},'YYYYMMDDHH24miss')
	</select>

	<select id="getRequestRegisterNewProductList" resultType="mrone.teamone.beans.ProductBean">
    	SELECT PR_CODE, PR_NAME, PR_STCODE FROM PR WHERE PR_STCODE = 'PR'
    </select>
    
    <select id="mroGetNewProductDetail" resultType="mrone.teamone.beans.ProductBean" parameterType="mrone.teamone.beans.ProductBean">
    	SELECT * FROM PR WHERE PR_CODE = #{pr_code}
    </select>
    
    <update id="mroResponseNewProduct" parameterType="mrone.teamone.beans.ProductBean">
    	UPDATE PR SET PR_STCODE = #{pr_stcode} WHERE PR_CODE = #{pr_code}
    </update>
    
     <select id="callModifyRequestList" resultType="mrone.teamone.beans.ProductBean">
    	SELECT PR_CODE, PR_NAME, PR_STCODE FROM PR WHERE PR_STCODE = 'MR' OR PR_STCODE = 'DR'
    </select>
    
    <select id="mroGetModifyProductDetail" resultType="mrone.teamone.beans.ProductBean" parameterType="mrone.teamone.beans.ProductBean">
    	SELECT * FROM PR WHERE PR_CODE = #{pr_code} AND PR_STCODE = #{pr_stcode}
    </select>
    
    <update id="mroResponseModifyProduct" parameterType="mrone.teamone.beans.ProductBean">
    	UPDATE PR SET PR_STCODE = #{pr_stcode} WHERE PR_CODE = #{pr_code} AND PR_STCODE = 'MR'
    </update>
 
    <update id="mroResponseDeleteProduct" parameterType="mrone.teamone.beans.ProductBean">
    	UPDATE PR SET PR_STCODE = #{pr_stcode} WHERE PR_CODE = #{pr_code} AND PR_STCODE = 'DR'
    </update>
    
    <update id="updatePCToPD" parameterType="mrone.teamone.beans.ProductBean">
    	UPDATE PR SET PR_STCODE = 'PD' WHERE PR_CODE = #{pr_code} AND PR_STCODE = 'PC'
    </update>
    
     <select id="stcodeCheck" parameterType="mrone.teamone.beans.ProductBean" resultType="int">
    	SELECT COUNT(*) FROM PR WHERE PR_CODE = #{pr_code} AND PR_STCODE = #{pr_stcode}
    </select>
    
    <delete id ="deleteStcode" parameterType="mrone.teamone.beans.ProductBean">
    	DELETE FROM PR WHERE PR_CODE = #{pr_code} AND PR_STCODE = #{pr_stcode} 
    </delete>

	<select id="getSupplyList" resultType="mrone.teamone.beans.SupplyInfoBean">
		SELECT SP.SP_CODE ,
       SP.SP_NAME,
       SP.SP_TEL,
       SP.SP_ADDRESS,
       SP.SP_CORPNUM,
       SP.SP_BKIND,
       BKIND.BK_NAME
		FROM SP INNER JOIN BKIND ON SP.SP_BKIND = BKIND.BK_CODE
    </select>
    
    <select id="getClientList" resultType="mrone.teamone.beans.ClientInfoBean">
    	
    	SELECT CL.CL_CODE,
      	 CL.CL_NAME,
      	 CL.CL_ADDRESS,
      	 CL.CL_CORPNUM,
      	 CL.CL_HP,
     	 CL.CL_BTYPE,
      	 CL.CL_BKIND,
     	 BK.BK_NAME
		FROM CL INNER JOIN BK ON CL_BKIND = BK.BK_CODE
    </select>
    
    <select id = "getWaitOrderList" resultType="mrone.teamone.beans.MroOrderBean">   
		SELECT * FROM ORDERSVIEW WHERE OS_STATE='OR'	    
    </select>
    
    <select id="getOrderDetail" parameterType="string" resultType="mrone.teamone.beans.MroOrderDetailBean" >
    	SELECT * FROM ORDERDETAILVIEW WHERE OD_OSCODE= #{osCode}
    </select>
    <!-- Mro 반품리스트 받아오는 쿼리 -->
    <select id="getRefundList" resultType="mrone.teamone.beans.MroOrderBean" >
    	SELECT * FROM ORDERSVIEW WHERE OS_STATE='RR'
    </select>
    
    <!-- Mro 교환리스트 받아오는 쿼리 -->
    <select id="getExchangeList" resultType="mrone.teamone.beans.MroOrderBean" >
    	SELECT * FROM ORDERSVIEW WHERE OS_STATE='ER'
    </select>
    
    <select id="getRefundDetail" parameterType="string" resultType="mrone.teamone.beans.MroOrderDetailBean" >
    	SELECT * FROM ORDERDETAILVIEW WHERE OD_OSCODE= #{osCode}
    </select>
 
 	<select id="getSearchSupplyList" parameterType="string" resultType="mrone.teamone.beans.SupplyInfoBean">
 	   SELECT SP.SP_CODE ,
       SP.SP_NAME,
       SP.SP_TEL,
       SP.SP_ADDRESS,
       SP.SP_CORPNUM,
       SP.SP_BKIND,
       BKIND.BK_NAME
		FROM SP INNER JOIN BKIND ON SP.SP_BKIND = BKIND.BK_CODE
        WHERE SP_NAME LIKE '%' || #{word} || '%'	
 	</select>

</mapper>